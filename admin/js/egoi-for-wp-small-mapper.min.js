!function(a){var e,i=a("#egoi_field_map"),t=a("#app_field_map"),n=a("#egoi_add_map"),o=a("#egoi_map_trigger"),r=a("#egoi_mapper"),c=a("#egoi_add_map_loader"),d=a("#egoi-small-mapped-fields"),l=a("#egoi_form_mappable"),p=a("#egoi_map_to_save"),s=a("#form_tag_wrapper"),u=!1;let h={name:"",id:"split",class:"dashicons dashicons-randomize",style:"height: auto;width: auto;padding-left: 0;"};function f(){0==t.val()||0==i.val()?n.prop("disabled",!0):n.prop("disabled",!1)}function g(e,i){i.children().each(function(i,t){var n=a(t);n.val()==e&&n.remove()})}function v(a){return{name:"",id:a,class:"dashicons dashicons-no-alt close-button-trigger",style:"height: auto;width: auto;padding-left: 0;"}}function m(e){d.children().each(function(i,t){a(t).append('<span style="'+e[i].style+'" class="'+e[i].class+'" egoidata="'+e[i].id+'">'+e[i].name+"</span>")})}l.submit(function(e){if(!u){void 0===p.val()&&e.preventDefault();var i=[];d.children().each(function(e,t){e%2==0&&a(t).children().each(function(e,t){void 0===i[e]&&(i[e]=[]),i[e].push(a(t).attr("egoidata"))})}),p.val(JSON.stringify(i)),u=!0,l.submit()}}),o.change(function(){var n,l,p;0!=o.val()&&(n=o.val(),r.show(300),s.show(300),c.show(),d.children().each(function(e,i){a(i).children().each(function(e,i){a(i).remove()})}),l=n,p={security:egoi_config_ajax_object.ajax_nonce,action:"egoi_get_mapping_n_fields",app:"gf",id:l},void 0!==e&&e.abort(),e=a.post(egoi_config_ajax_object.ajax_url,p,function(e){var n;if(c.hide(),void 0!==(e=(n=e,"string"==typeof n?JSON.parse(n):n)).success&&!1===e.success){alert(e.data);return}(function e(n){for(let[o,r]of(0!==n.mapped.length&&function a(e){for(let[i,t]of Object.entries(e.mapped)){var n=[];n.push({name:e.fields[i],id:i}),n.push(h),n.push({name:e.egoi_fields[t],id:t}),n.push(v(t)),m(n)}}(n),t.children().each(function(e,i){var t=a(i);"0"!=t.val()&&t.remove()}),i.children().each(function(e,i){var t=a(i);"0"!=t.val()&&t.remove()}),Object.entries(n.fields)))void 0===n.mapped[o]&&t.append('<option value="'+o+'">'+r+"</option>");for(let[c,d]of Object.entries(n.egoi_fields))!Object.values(n.mapped).includes(c)&&i.append('<option value="'+c+'">'+d+"</option>");void 0!==n.tag&&""!=n.tag?a("#form_tag").attr("data-egoi-tag",n.tag):a("#form_tag").attr("data-egoi-tag",""),a(document).trigger("data-attribute-changed")})(e.data)}),a("#form_tag").val(null))}),a(document).on("click",".close-button-trigger",function(){var e=[],n=a(this).attr("egoidata");a(d.children()[3]).children().each(function(i,t){a(t).attr("egoidata")==n&&d.children().each(function(t,n){a(n).children().each(function(t,n){if(t==i){e.push(n),a(n).remove();return}})})});var o=a(e[0]),r=a(e[2]);t.append('<option value="'+o.attr("egoidata")+'" >'+o.text()+"</option>"),i.append('<option value="'+r.attr("egoidata")+'" >'+r.text()+"</option>")}),t.change(function(){f()}),i.change(function(){f()}),n.on("click",function(){e=[],t.children().each(function(i,n){var o=a(n);if(o.val()==t.val()){e.push({name:o.html(),id:o.val()});return}}),e.push(h),i.children().each(function(t,n){var o=a(n);if(o.val()==i.val()){e.push({name:o.html(),id:o.val()}),e.push(v(o.val()));return}}),m(e);var e,n=i.val(),o=t.val();g(n,i),g(o,t),f()}),f()}(jQuery);