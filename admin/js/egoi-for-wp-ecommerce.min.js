jQuery(document).ready(function(){!function(t){let a="idgoi";var e,o,i=0,c=0,n=t("#delete_catalog_loader"),l=t("#egoi-loader-products"),r=t("#importModal"),s=t("#confirmDeleteModal"),d=t(".sync_catalog"),g=t(".variations_catalog"),u=t(".force_catalog"),h=t("#force_catalog_glob"),$=t("#catalog_glob_status"),f=t(".remove_catalog"),p=t("#new_catalog_page"),m=egoi_config_ajax_object_ecommerce;t(".smsnf-table >tbody");var v=t("#selected-import-catalog"),_=t("#display-selected"),x=t("#start-import-catalog"),w=t("#display-number-products"),b=t("#egoi-left-products"),k=t("#loading-import"),y=t("#progressbar-import"),j=t("#selected-delete-catalog"),M=t("#verified-delete-catalog"),C=t("#verified-delete-catalog-span"),D=t("#egoi-success"),q=t("#egoi-success-message"),z=t("#egoi-alert"),A=t("#egoi-alert-message"),B=t(".egoi-simple-close-x"),E=t("#close_modal_catalog"),F=t("#cancel_modal_catalog");function G(a){l.show(),w.text(""),b.text(""),t.get(m.ajax_url,{action:"egoi_count_products",catalog:a},function(t){if(l.hide(),!1===(t=H(t)))return!1;w.text(t),b.text(t),i=0,c=Math.ceil(parseInt(t)/100),x.attr("disabled",!1)})}function H(t){var a,e;return void 0!==(t=(a=t,"string"==typeof a?JSON.parse(a):a)).success&&!1===t.success?(e=t.data,A.text(e),console.error(e),z.show(300),r.modal("hide"),!1):t.data}function I(){y.css("width","0%")}E.on("click",function(){s.modal("hide")}),F.on("click",function(){s.modal("hide")}),d.change(function(){var o,i,c,l;i=(o=[],d.each(function(){t(this).is(":checked")&&o.push(t(this).attr(a))}),o),l={security:m.ajax_nonce,action:"egoi_sync_catalog",data:i},void 0!==e&&e.abort(),n.show(),t(c).attr("disabled",!0),e=t.post(m.ajax_url,l,function(a){return n.hide(),t(c).attr("disabled",!1),!1!==(a=H(a))})}),g.change(a=>{a=t(a.target),console.log(a[0].checked);let e={security:m.ajax_nonce,action:"egoi_variations_catalog",catalog_id:a.attr("idgoi"),status:a[0].checked};t.post(m.ajax_url,e,function(t){console.log("saved")})}),M.on("click",function(){var a,e,i;a=j.val(),e=o,console.log("deleting catalog: "+a),i={security:m.ajax_nonce,action:"egoi_delete_catalog",id:a},n.show(),C.hide(),t(e).attr("disabled",!0),t.post(m.ajax_url,i,function(a){if(n.hide(),C.show(),t(e).attr("disabled",!1),a=H(a),console.log(a),!1===a)return!1;s.modal("hide"),location.reload()})}),r.on("hidden.bs.modal",function(){x.attr("disabled",!0),I(),k.hide()}),h.on("click",e=>{let o=t(e.target).attr(a);o&&(v.val(o),_.text(o),G(o),r.modal("show"))}),u.on("click",function(){var e=t(this);e.removeClass("egoi-pulsating"),t(".smsnf-notification").hide(300);var o=e.attr(a);v.val(o),_.text(o),G(o),r.modal("show")}),x.on("click",function(){x.attr("disabled",!0),k.show(),function e(o,n=""){if(i>=c)return setTimeout(function(){var t;$.val(1),$.trigger("change"),k.hide(300),I(),r.modal("toggle"),t=n,q.text(t),D.show(300)},1e3),d.each(function(){t(this).attr(a)==o&&(t(this).prop("checked",!0),t(this).trigger("change"))}),!0;var l={security:m.ajax_nonce,action:"egoi_force_import_catalog",id:o,page:i++};t.post(m.ajax_url,l,function(t){var a,i,n;if(!1===(t=H(t)))return!1;0==c&&(c=1),i=1/c*100,n=y.width()/y.parent().width()*100,console.log("adding %s percent. now %s",i,n),parseInt(n)+i>=100?i=100:i+=n,y.width(i+"%"),a=parseInt(b.text()),(a-=100)<0&&(a=0),b.text(a),e(o,t)})}(v.val()),console.log("importing catalog: "+v.val())}),f.on("click",function(){j.val(t(this).attr(a)),s.modal("show"),o=this}),B.on("click",function(){t(t(t(this).parent()[0]).parent()[0]).hide()}),p.on("click",function(){window.location.href=window.location.href+"&subpage=new_catalog"})}(jQuery)});