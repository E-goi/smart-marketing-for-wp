jQuery(document).ready(function(){!function(t){let a="idgoi";var e,o,i=0,c=0,n=t("#egoi-loader"),r=t("#egoi-loader-products"),l=t("#importModal"),s=t("#confirmDeleteModal"),d=t(".sync_catalog"),g=t(".variations_catalog"),u=t(".force_catalog"),h=t("#force_catalog_glob"),$=t("#catalog_glob_status"),f=t(".remove_catalog"),p=t("#new_catalog_page"),v=egoi_config_ajax_object_ecommerce,m=t(".smsnf-table >tbody"),_=t("#selected-import-catalog"),x=t("#display-selected"),b=t("#start-import-catalog"),w=t("#display-number-products"),k=t("#egoi-left-products"),y=t("#loading-import"),j=t("#progressbar-import"),M=t("#selected-delete-catalog"),C=t("#verified-delete-catalog"),D=t("#egoi-success"),q=t("#egoi-success-message"),z=t("#egoi-alert"),A=t("#egoi-alert-message"),B=t(".egoi-simple-close-x");function E(a){r.show(),w.text(""),k.text(""),t.get(v.ajax_url,{action:"egoi_count_products",catalog:a},function(t){if(r.hide(),!1===(t=F(t)))return!1;w.text(t),k.text(t),i=0,c=Math.ceil(parseInt(t)/100),b.attr("disabled",!1)})}function F(t){var a,e;return void 0!==(t=(a=t,"string"==typeof a?JSON.parse(a):a)).success&&!1===t.success?(e=t.data,A.text(e),console.error(e),z.show(300),l.modal("hide"),!1):t.data}function G(){j.css("width","0%")}d.change(function(){var o,i,c,r;i=(o=[],d.each(function(){t(this).is(":checked")&&o.push(t(this).attr(a))}),o),r={security:v.ajax_nonce,action:"egoi_sync_catalog",data:r},void 0!==e&&e.abort(),n.show(),t(c).attr("disabled",!0),e=t.post(v.ajax_url,r,function(a){return n.hide(),t(c).attr("disabled",!1),!1!==(a=F(a))})}),g.change(a=>{a=t(a.target),console.log(a[0].checked);let e={security:v.ajax_nonce,action:"egoi_variations_catalog",catalog_id:a.attr("idgoi"),status:a[0].checked};t.post(v.ajax_url,e,function(t){console.log("saved")})}),C.on("click",function(){var a,e,i;a=M.val(),e=o,i={security:v.ajax_nonce,action:"egoi_delete_catalog",id:a},n.show(),t(e).attr("disabled",!0),t.post(v.ajax_url,i,function(a){if(n.hide(),t(e).attr("disabled",!1),!1===(a=F(a)))return!1;t(t(t(e).parent()[0]).parent()[0]).remove(),setTimeout(function(){d.trigger("change"),("undefined"===m.children().length||m.children().length<1)&&location.reload()},200)})}),l.on("hidden.bs.modal",function(){b.attr("disabled",!0),G(),y.hide()}),h.on("click",e=>{let o=t(e.target).attr(a);o&&(_.val(o),x.text(o),E(o),l.modal("show"))}),u.on("click",function(){var e=t(this);e.removeClass("egoi-pulsating"),t(".smsnf-notification").hide(300);var o=e.attr(a);_.val(o),x.text(o),E(o),l.modal("show")}),b.on("click",function(){b.attr("disabled",!0),y.show(),function e(o,n=""){if(i>=c)return setTimeout(function(){var t;$.val(1),$.trigger("change"),y.hide(300),G(),l.modal("toggle"),t=n,q.text(t),D.show(300)},1e3),d.each(function(){t(this).attr(a)==o&&(t(this).prop("checked",!0),t(this).trigger("change"))}),!0;var r={security:v.ajax_nonce,action:"egoi_force_import_catalog",id:o,page:i++};t.post(v.ajax_url,r,function(t){var a,i,n;if(!1===(t=F(t)))return!1;0==c&&(c=1),i=1/c*100,n=j.width()/j.parent().width()*100,console.log("adding %s percent. now %s",i,n),parseInt(n)+i>=100?i=100:i+=n,j.width(i+"%"),a=parseInt(k.text()),(a-=100)<0&&(a=0),k.text(a),e(o,t)})}(_.val()),console.log("importing catalog: "+_.val())}),f.on("click",function(){M.val(t(this).attr(a)),s.modal("show"),o=this}),B.on("click",function(){t(t(t(this).parent()[0]).parent()[0]).hide()}),p.on("click",function(){window.location.href=window.location.href+"&subpage=new_catalog"})}(jQuery)});